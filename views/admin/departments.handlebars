<link rel="stylesheet" href="/styles/error.css">
<div class="container mt-5">
    <h1>Department List</h1>

    <input type="hidden" id="csrf" value="{{_csrf}}">
    {{#if error}}
    <p>Error: {{error}}</p>
    {{/if}}
    <table class="table">
        <thead>
            <tr>
                <th>Department Name</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{#each departmentList}}
            <tr>
                <td>{{departmentName}}</td>
                <td>
                    <!-- Edit button to open the Bootstrap modal -->
                    <button id="editModalButton{{_id}}" type="button" class="btn btn-primary"
                        onclick="openEditModal('{{_id}}', '{{departmentName}}')">Edit</button>

                    <!-- Delete button with a form to submit the delete request -->
                    <form method="POST" action="/configuration/departments/delete/{{_id}}" style="display:inline;">
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>

    <!-- Add button to open the Bootstrap modal -->
    <button id="addModalButton" type="button" class="btn btn-primary" data-toggle="modal" data-target="#addModal">
        Add Department
    </button>

    <!-- Add Modal -->
    <div class="modal" id="addModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Add Department</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal Body -->
                <div class="modal-body">
                    <!-- Add department form -->
                    <form id="addDepartmentForm" method="POST" action="/configuration/departments/register">
                        <div class="form-group">
                            <label for="addDepartmentName">Department Name:</label>
                            <input type="text" class="form-control" id="addDepartmentName" name="departmentName"
                                required>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" onclick="submitForm(event)">Add
                            Department</button>
                    </form>
                    <div id="addFormError" style="color: red;"></div>
                </div>

                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary close" data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal" id="editModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Edit Department</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal Body -->
                <div class="modal-body">
                    <!-- Add department form -->
                    <form id="editDepartmentForm" method="POST" action="/configuration/departments/register">
                        <div class="form-group">
                            <input type="text" class="form-control" id="editDepartmentId" name="departmentId" required
                                hidden>
                        </div>
                        <div class="form-group">
                            <label for="editDepartmentName">Department Name:</label>
                            <input type="text" class="form-control" id="editDepartmentName" name="departmentName"
                                required>
                        </div>
                        <br>
                        <button type="submit" class="btn btn-primary" onclick="submitEditForm(event)">Edit
                            Department</button>
                    </form>
                    <div id="editFormError" style="color: red;"></div>
                </div>

                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary close" data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>


</div>